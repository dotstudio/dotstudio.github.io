<!doctype html><html lang=ja><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="京急線が遅延した時、勤務先に簡単に報告できるツールを作成しました！"><meta name=author content="dotstudio Inc."><meta content="https://dotstud.io/img/blog/243/00_eyecatch.png"><meta itemprop=name content="【どんと来い、列車遅延】 勤怠メールをサクッと送れるオレオレツールを作ってみた | dotstudio"><meta itemprop=image content="https://dotstud.io/img/blog/243/00_eyecatch.png"><meta property="og:title" content="【どんと来い、列車遅延】 勤怠メールをサクッと送れるオレオレツールを作ってみた | dotstudio"><meta property="og:locale" content="ja_JP"><meta property="og:type" content="article"><meta property="og:url" content="https://dotstud.io/blog/pokio-nodered-keikyu-chien/"><meta property="og:site_name" content="dotstudio（ドットスタジオ）"><meta property="og:image" content="https://dotstud.io/img/blog/243/00_eyecatch.png"><meta property="og:image:secure_url" content="https://dotstud.io/img/blog/243/00_eyecatch.png"><meta property="og:description" content="京急線が遅延した時、勤務先に簡単に報告できるツールを作成しました！"><meta property="article:author" content="https://www.facebook.com/dotstud10/"><meta property="fb:app_id" content="296336307370435"><meta property="fb:pages" content="1013196712108753"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image:src content="https://dotstud.io/img/blog/243/00_eyecatch.png"><meta name=twitter:site content="@dotstud_io"><meta name=twitter:url content="https://dotstud.io/blog/pokio-nodered-keikyu-chien/"><meta name=twitter:description content="京急線が遅延した時、勤務先に簡単に報告できるツールを作成しました！"><meta name=twitter:title content="【どんと来い、列車遅延】 勤怠メールをサクッと送れるオレオレツールを作ってみた | dotstudio"><meta name=twitter:creator content="@dotstud_io"><meta name=google-site-verification content="oW2fcSG1fFnkDoRCGFJ0IGGebtBr8FjV2twoFMd7Skc"><title>【どんと来い、列車遅延】 勤怠メールをサクッと送れるオレオレツールを作ってみた | dotstudio</title><link rel=stylesheet href=/css/loader.css><link rel=stylesheet href=/css/master.css><link rel=stylesheet href=/css/icon-font.css><link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel=stylesheet><link rel="shortcut icon" type=image/png href=/img/resources/favicon.png><link href=//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css rel=preload as=style onload="this.rel='stylesheet'"><link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel=preload as=style onload="this.rel='stylesheet'"><link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel=preload as=style onload="this.rel='stylesheet'"><link href=/css/lib/hljs.css rel=preload as=style onload="this.rel='stylesheet'"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-K5TRM9Q');</script><script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-5922216421588455",enable_page_level_ads:true});</script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K5TRM9Q" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><div id=fb-root></div><script>(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="//connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.8";fjs.parentNode.insertBefore(js,fjs);}(document,'script','facebook-jssdk'));</script><header><svg style="position:absolute;width:0;height:0;overflow:hidden" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><symbol id="icon-arrow-right" viewBox="0 0 32 32"><title>arrow-right</title><path class="path1" fill="none" stroke="#000" stroke-width="4.5714" stroke-miterlimit="4" stroke-linecap="square" stroke-linejoin="miter" d="M5.143 5.143l10.349 10.349"/><path class="path2" fill="none" stroke="#000" stroke-width="4.5714" stroke-miterlimit="4" stroke-linecap="square" stroke-linejoin="miter" d="M5.143 26.857l10.349-10.349"/><path class="path3" fill="none" stroke="#000" stroke-width="4.5714" stroke-miterlimit="4" stroke-linecap="square" stroke-linejoin="miter" d="M16.571 26.857 26.92 16.508"/><path class="path4" fill="none" stroke="#000" stroke-width="4.5714" stroke-miterlimit="4" stroke-linecap="square" stroke-linejoin="miter" d="M16.571 5.143 26.92 15.492"/></symbol><symbol id="icon-hamburger" viewBox="0 0 60 32"><title>hamburger</title><path class="path1" fill="none" stroke="gray" stroke-width="7.1111" stroke-miterlimit="4" stroke-linecap="square" stroke-linejoin="miter" d="M3.556 3.556h53.333"/><path class="path2" fill="none" stroke="gray" stroke-width="7.1111" stroke-miterlimit="4" stroke-linecap="square" stroke-linejoin="miter" d="M3.556 28.444h53.333"/></symbol><symbol id="icon-logo-mark" viewBox="0 0 32 32"><title>logo-mark</title><path class="path1" d="M19.731 28.8H0v-19.699h19.731zM1.53 27.302h16.672v-16.672h-16.672z"/><path class="path2" d="M32 22.899h-19.731v-19.699H32zM13.798 21.37H30.47V4.698h-16.672z"/></symbol><symbol id="icon-social-facebook" viewBox="0 0 32 32"><title>social-facebook</title><path class="path1" d="M30.1.12h-28.46c-.974.011-1.76.804-1.76 1.78v28.46c0 .983.797 1.78 1.78 1.78h15.32v-12.4h-4.16v-4.82h4.16v-3.58c-.02-.179-.031-.386-.031-.596.0-3.203 2.597-5.8 5.8-5.8.152.0.302.006.45.017-.016-.001-.013-.001-.009-.001 1.3.0 2.582.073 3.844.214l-.155 4.286h-2.54c-2 0-2.36.96-2.36 2.36v3.1h4.76l-.62 4.8h-4.12v12.4h8.12c.983.0 1.78-.797 1.78-1.78v-28.44c0-.983-.797-1.78-1.78-1.78z"/></symbol><symbol id="icon-social-github" viewBox="0 0 32 32"><title>social-github</title><path class="path1" d="M16 .4c-.001.0-.002.0-.004.0-8.837.0-16 7.163-16 16 0 7.028 4.531 12.997 10.831 15.147.913.173 1.213-.307 1.213-.747s-.04-1.38-.04-2.8c-4.44 1.06-5.38-2-5.38-2-.308-.987-.937-1.798-1.763-2.33-1.477-1.01.103-.99.103-.99 1.055.144 1.941.76 2.451 1.624.607 1.039 1.701 1.715 2.953 1.715.6.0 1.164-.155 1.653-.428.062-.836.437-1.58 1.002-2.13-3.559-.401-7.279-1.781-7.279-8.001-.001-.032-.001-.069-.001-.106.0-1.621.624-3.096 1.645-4.198-.181-.526-.283-1.135-.283-1.769.0-.85.184-1.657.514-2.383s1.325-.404 4.385 1.676c1.199-.341 2.577-.537 4-.537s2.801.196 4.107.562c2.953-2.026 4.293-1.666 4.293-1.666.31.683.49 1.481.49 2.321.0.688-.121 1.348-.343 1.959 1.03 1.058 1.654 2.533 1.654 4.154.0.037.0.075-.001.112.0 6.134-3.74 7.494-7.3 7.894.685.69 1.108 1.641 1.108 2.69.0.088-.003.175-.009.261.001 2.128.001 3.848.001 4.368s.28.92 1.1.78c6.413-2.183 10.944-8.152 10.944-15.18.0-8.837-7.163-16-16-16-.015.0-.031.0-.046.0z"/></symbol><symbol id="icon-social-twitter" viewBox="0 0 32 32"><title>social-twitter</title><path class="path1" d="M10 29c.036.0.078.0.12.0 10.25.0 18.56-8.31 18.56-18.56.0-.042.0-.085.0-.127.0-.274.0-.554.0-.834 1.312-.959 2.414-2.113 3.289-3.431-1.07.454-2.347.82-3.686.984 1.293-.819 2.312-2.084 2.804-3.587-1.184.679-2.577 1.234-4.062 1.539-1.286-1.244-2.976-2.027-4.849-2.027-3.634.0-6.58 2.946-6.58 6.58.0.518.06 1.022.173 1.506-5.473-.309-10.286-2.887-13.523-6.813-.587.917-.919 2.059-.919 3.278.0 2.258 1.137 4.25 2.871 5.435-1.063-.025-2.07-.325-2.95-.822l.032.017c0 .027-.001.058-.001.09.0 3.163 2.239 5.803 5.218 6.423-.479.156-1.078.242-1.696.242-.432.0-.854-.042-1.263-.121.908 2.637 3.319 4.512 6.175 4.567-2.208 1.746-5.039 2.8-8.116 2.8-.013.0-.027.0-.04.0-.566-.018-1.104-.068-1.633-.149 2.897 1.868 6.353 2.984 10.068 3.009z"/></symbol></defs></svg><div class=header><span class=logo><a href=/><svg id="icon-logo"><use xlink:href="#icon-logo-mark"/></a></span><div class=menu><input type=checkbox id=menu-toggle>
<label for=menu-toggle class=label-toggle><svg class="icon-hamburger"><use xlink:href="#icon-hamburger"/></label></input><ul><li class=menu-item><a href=/blog>Blog</a></li><li class=menu-item><a href=/docs>Docs</a></li><li class=menu-item><a href=/shop>Shop</a></li><li class=menu-item><a href=/members>Members</a></li><li class=menu-item><a href=/service>Service</a></li><li class=menu-item><a href=/about>About</a></li></ul></div></div></header><ul class=categories><li><a href=/categories/try/ class=selected>やってみるIoT</a></li><li><a href=/categories/learn/>IoTを知ろう</a></li><li><a href=/categories/event/>イベントレポート</a></li><li><a href=/categories/tips/>Tips</a></li></ul><article class=blog-single><div class=date>2019.02.13</div><img class=blog-single--eyecatch src=/img/blog/243/00_eyecatch.png alt width=710px><h1 class=blog-single--title>【どんと来い、列車遅延】 勤怠メールをサクッと送れるオレオレツールを作ってみた</h1><div class=blog-single--information><a class=author href=/members/pokio><img src=/img/members/pokio/author.png alt class=author--avatar><p class=author--name>ポキオ</p></a><a class=series href=/series/nodejs>Node.js Magazine</a></div><div id=fb-root></div><script>(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src='https://connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v3.1&appId=172686636611828&autoLogAppEvents=1';fjs.parentNode.insertBefore(js,fjs);}(document,'script','facebook-jssdk'));</script><div class=share><a href=https://twitter.com/share class=twitter-share-button data-size=large data-show-count=true data-hashtags=dotstudio>Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','twitter-wjs');</script>&nbsp;<div class=fb-share-button data-href=https://dotstud.io/blog/pokio-nodered-keikyu-chien/ data-layout=button_count data-size=large data-mobile-iframe=true><a target=_blank href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdotstud.io%2Fblog%2Fmftokyo-2018-chantoku-report%2F&src=sdkpreparse" class=fb-xfbml-parse-ignore>シェア</a></div>&nbsp;
<a href=https://dotstud.io/blog/pokio-nodered-keikyu-chien/ class=hatena-bookmark-button data-hatena-bookmark-layout=basic-counter data-hatena-bookmark-height=30 title=このエントリーをはてなブックマークに追加><img src=https://b.st-hatena.com/images/entry-button/button-only@2x.png alt=このエントリーをはてなブックマークに追加 width=20 height=20 style=border:none></a><script type=text/javascript src=https://b.st-hatena.com/js/bookmark_button.js async></script>
&nbsp;<div class=line-it-button data-lang=ja data-type=share-c data-url=https://dotstud.io/blog/pokio-nodered-keikyu-chien/ style=display:none></div><script src=https://d.line-scdn.net/r/web/social-plugin/js/thirdparty/loader.min.js async defer></script></div><div class="blog-single--content markdown"><p>こんにちは、<a href=/members/pokio>ポキオ</a>です。</p><p>急いでるときに限って、いつも使ってる通勤列車が遅延してたりして、あたふたすることってありますよね？</p><p>そんなときに、勤務先などにサクッとメールを送れるオレオレツールを作ってみました。</p><h2 id=node-red>Node-REDで簡単に作ってみる</h2><p>「ツールを作る」と聞くと、なんだか難しそうな雰囲気がしますよね？</p><p>でも、<strong>Node-RED</strong>を使うとちょっとのコーディングで簡単にツールが作れてしまいます！<a href=https://dotstud.io/blog/nefry-servo-handson-takudooon/#node-red-mqtt%E3%81%A7%E3%82%B5%E3%83%BC%E3%83%9C%E3%83%A2%E3%83%BC%E3%82%BF%E3%82%92%E9%81%A0%E9%9A%94%E5%88%B6%E5%BE%A1>たくろーどんさんの記事</a>でもNode-REDが使われていましたが、<strong>実行したい処理をフローチャートのように、ノードとノードをつなぐことによって設計できるツール</strong>になっています。</p><p>Node-REDはその名の通り、<strong>Node.js</strong>上で動作するツールです。普段使っているPCなどNode.jsが動作している環境であればNode−REDを動かすことができますが、今回は外出先からでもアクセスできるツールを簡単に作成したかったので、Node-REDをサービスとして提供している<strong>enebular</strong>を使ってみようと思います。</p><h2 id=node-red-1>Node-REDでツールを作ってみる</h2><p>はじめに、今回作ったツールがこちら。</p><p>このツールの機能は、以下の3つです。</p><ul><li>外出先からでもアクセスできるWebページを作る（念の為、BASIC認証を設けておく）</li><li>そのページ上で勤怠メールの文言をプリセットから選べるようにして、特定の宛先にメール送信できるようにする</li><li>**「本当に電車遅延が原因で遅刻するの？」**と言われないように、京急の遅延証明書ページで発行されている遅延証明書を表示して、メールに遅延証明書へのリンクを貼れるようにする</li></ul><p>遅延状況は例によって<strong>京浜急行</strong>のWebページ上の情報を取得しています。また、不特定多数の人が勝手にこのツールを使ってしまわないように、BASIC認証を設けてアクセスを制限しています。</p><h2 id=node-redweb>Node-REDでWebページを作る</h2><p>Node-REDで用意されているノードのなかに、HTTPリクエストを受ける<strong><code>HTTP In</code></strong>ノードと、それに対するレスポンスを返す<strong><code>HTTP Response</code></strong>ノードがあります。</p><p>この<code>HTTP In</code>ノードを作るとHTTPのエンドポイントができます。このノードと<code>HTTP Response</code>ノードを下の絵のようにつなぎ、レスポンスとなるソースを返すようにすれば、Webページができます。</p><p>上の例では、静的な<code>Hello, world!</code>という文字列を返すだけですが、<strong><code>HTTP Response</code></strong>ノードで返す情報を動的に変化させたり、Webページ上で動作させるスクリプトを記述してレスポンスとして返せば、よりリッチなWebページをNode-REDで作成することができます。
</p><p>次にBASIC認証ですが、Node-REDに対して追加でモジュールをインストールすることで、簡単に機能を追加することができます。</p><p>Node-REDの設定メニューから、[Settings] > [Palette] > [Install]と進み、<strong><code>node-red-contrib-httpauth</code></strong>を探します。</p><p>これをインストールすることで、BASIC認証が行えるノードを追加できます。</p><p>使い方は至ってシンプルで、先程の<code>HTTP In</code>ノードの後ろにBASIC認証のノードをつけて、BASIC認証で使うユーザー名とパスワードをノードの設定で指定するだけです。</p><p>実際に、この状態でエンドポイントにアクセスすると、確かにBASIC認証がワークしています。</p><h2 id=heading>勤怠メールを送れるようにする</h2><p>ここまでで、<code>Hello, world!</code>が表示できるWebページができました。ここからは<code>HTTP Response</code>ノードで返すHTMLをよしなに編集して、勤怠メールを作成できるようにします。</p><p>具体的には、次のような機能をHTMLやJavaScriptで記述して、それをレスポンスで返すようにしました。</p><ul><li>プルダウンメニューで遅刻する理由を選択できるようにする</li><li>選択した理由に応じて、メールの本文を変更する</li><li><strong>mailtoスキーム</strong>を使って、メーラーを起動してメールを送れるようにする</li></ul><p>遅刻の理由も、必ずしも電車遅延だけではないので、体調不良や保育園関係の理由も選択できるようにしました。</p><p>遅刻の理由を選択すると、メール本文が変わるようになっています。</p><p><strong><code>勤怠メールを送る</code></strong>を押すとメーラーが起動し、ツールで指定した文言をそのままメールとして送ることができます。</p><h2 id=heading-1>遅延証明書情報を取得する</h2><p>ツール上で表示する京浜急行の運行情報は、<a href=https://delay.keikyu.co.jp/delay/>京急線遅延証明書の発行</a>のページから取得します。</p><p>その日に発行されている遅延証明書のリスト化し、その遅延証明書ページへのリンクをメール本文に貼り付けるか選択できるようになっています。</p><p>ただし、下記のような問題があるため、泥臭いワークアラウンドを入れています。</p><ul><li>遅延証明書ページへのリンクのアドレスに、mailtoスキームでは扱えない文字が含まれているため、<a href=https://is.gd/>外部のURL短縮サービス「is.gd」</a>を使ってアドレスを短く変換している</li><li>URL短縮のWebAPIを叩こうとするとCORSポリシーに引っかかったため、URL短縮のために同じドメインでエンドポイントを作成し、それ経由でアドレスの変換を行う</li></ul><h2 id=heading-2>実際のフローはこちら</h2><p>Node-REDで作成したフローを、エクスポートしたものはこちらです。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON>[{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;tab&#34;</span>,<span style=color:#f92672>&#34;label&#34;</span>:<span style=color:#e6db74>&#34;Flow 1&#34;</span>,<span style=color:#f92672>&#34;disabled&#34;</span>:<span style=color:#66d9ef>false</span>,<span style=color:#f92672>&#34;info&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;a45bf2b.b54621&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;http request&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;遅延証明書ページ取得&#34;</span>,<span style=color:#f92672>&#34;method&#34;</span>:<span style=color:#e6db74>&#34;GET&#34;</span>,<span style=color:#f92672>&#34;ret&#34;</span>:<span style=color:#e6db74>&#34;txt&#34;</span>,<span style=color:#f92672>&#34;url&#34;</span>:<span style=color:#e6db74>&#34;https://delay.keikyu.co.jp/delay/&#34;</span>,<span style=color:#f92672>&#34;tls&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>360</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>180</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[[<span style=color:#e6db74>&#34;89f0f7a0.a8bda8&#34;</span>]]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;3a7ae4dc.fc9f5c&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;debug&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;active&#34;</span>:<span style=color:#66d9ef>true</span>,<span style=color:#f92672>&#34;tosidebar&#34;</span>:<span style=color:#66d9ef>true</span>,<span style=color:#f92672>&#34;console&#34;</span>:<span style=color:#66d9ef>false</span>,<span style=color:#f92672>&#34;tostatus&#34;</span>:<span style=color:#66d9ef>false</span>,<span style=color:#f92672>&#34;complete&#34;</span>:<span style=color:#e6db74>&#34;delayData&#34;</span>,<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>600</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>220</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;89f0f7a0.a8bda8&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;function&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;情報をパース&#34;</span>,<span style=color:#f92672>&#34;func&#34;</span>:<span style=color:#e6db74>&#34;let table = msg.payload.split(&#39;&lt;tbody&gt;&#39;)[1];\ntable = table.split(&#39;&lt;/tbody&gt;&#39;)[0];\n\nlet rows = table.split(&#39;\\n&#39;).join(&#39;&#39;);\nrows = rows.split(&#39;&lt;tr&gt;&#39;).join(&#39;&#39;).split(&#39;&lt;/tr&gt;&#39;);\n\nlet data = {};\nlet dateOffset = 0;\ndata.date = rows[0 + 3 * dateOffset].split(&#39;&lt;/td&gt;&#39;)[0].replace(&#39;&lt;tr style=\&#34;background-color:#ADD8E6;\&#34;&gt;&#39;,&#39;&#39;).replace(&#39;&lt;td rowspan=3&gt;&#39;,&#39;&#39;).replace(&#39;&lt;br/&gt;&#39;,&#39;&#39;);\n\nlet morningData = rows[0 + 3 * dateOffset].split(&#39;&lt;/td&gt;&#39;).join(&#39;&#39;).split(&#39;&lt;td&gt;&#39;).slice(1);\nlet dayData = rows[1 + 3 * dateOffset].split(&#39;&lt;/td&gt;&#39;).join(&#39;&#39;).split(&#39;&lt;td&gt;&#39;).slice(1);\nlet nightData = rows[2 + 3 * dateOffset].split(&#39;&lt;/td&gt;&#39;).join(&#39;&#39;).split(&#39;&lt;td&gt;&#39;).slice(1);\nlet dataTitles = [&#39;品川～横浜：上り&#39;,&#39;品川～横浜：下り&#39;,&#39;横浜以南：上り&#39;,&#39;横浜以南：下り&#39;,&#39;空港線内：上り&#39;,&#39;空港線内：下り&#39;];\n\ndata.morningTitle = morningData[0];\ndata.dayTitle = dayData[0];\ndata.nightTitle = nightData[0];\n\nmorningData = morningData.slice(1);\ndayData = dayData.slice(1);\nnightData = nightData.slice(1);\n\ndata.morningData = [];\ndata.dayData = [];\ndata.nightData = [];\ndata.allData = [];\n\nfor(let i = 0; i &lt; 6; i++){\n    if(morningData[i] !== &#39;-&#39;){\n        let detail = morningData[i].split(&#39;&gt;&#39;)[1].split(&#39;&lt;&#39;)[0];\n        let link = &#39;https://delay.keikyu.co.jp&#39; + morningData[i].split(&#39;\&#34;&#39;)[1];\n        data.morningData.push({zone : dataTitles[i], detail : detail, link : link});\n        data.allData.push({title : data.morningTitle + &#39; - &#39; +  dataTitles[i] + &#39; - &#39; + detail, link : link});\n    }\n    \n    if(dayData[i] !== &#39;-&#39;){\n        let detail = dayData[i].split(&#39;&gt;&#39;)[1].split(&#39;&lt;&#39;)[0];\n        let link = &#39;https://delay.keikyu.co.jp&#39; + dayData[i].split(&#39;\&#34;&#39;)[1];\n        data.dayData.push({zone : dataTitles[i], detail : detail, link : link});\n        data.allData.push({title : data.dayTitle + &#39; - &#39; +  dataTitles[i] + &#39; - &#39; + detail, link : link});\n    }\n    \n    if(nightData[i] !== &#39;-&#39;){\n        let detail = nightData[i].split(&#39;&gt;&#39;)[1].split(&#39;&lt;&#39;)[0];\n        let link = &#39;https://delay.keikyu.co.jp&#39; + nightData[i].split(&#39;\&#34;&#39;)[1];\n        data.nightData.push({zone : dataTitles[i], detail : detail, link : link});\n        data.allData.push({title : data.nightTitle + &#39; - &#39; +  dataTitles[i] + &#39; - &#39; + detail, link : link});\n    }\n}\n\nmsg.delayData = data;\nreturn msg;&#34;</span>,<span style=color:#f92672>&#34;outputs&#34;</span>:<span style=color:#ae81ff>1</span>,<span style=color:#f92672>&#34;noerr&#34;</span>:<span style=color:#ae81ff>0</span>,<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>340</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>220</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[[<span style=color:#e6db74>&#34;e0512d8a.0fe7f&#34;</span>,<span style=color:#e6db74>&#34;3a7ae4dc.fc9f5c&#34;</span>]]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;5c37249e.aecf1c&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;http in&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;HTTPリクエスト&#34;</span>,<span style=color:#f92672>&#34;url&#34;</span>:<span style=color:#e6db74>&#34;/&#34;</span>,<span style=color:#f92672>&#34;method&#34;</span>:<span style=color:#e6db74>&#34;get&#34;</span>,<span style=color:#f92672>&#34;upload&#34;</span>:<span style=color:#66d9ef>false</span>,<span style=color:#f92672>&#34;swaggerDoc&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>120</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>180</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[[<span style=color:#e6db74>&#34;b83cd390.27959&#34;</span>]]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;bbc86a41.f453e8&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;http response&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;HTTPレスポンス&#34;</span>,<span style=color:#f92672>&#34;statusCode&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;headers&#34;</span>:{},<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>610</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>180</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;e0512d8a.0fe7f&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;function&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;パースした情報を整形&#34;</span>,<span style=color:#f92672>&#34;func&#34;</span>:<span style=color:#e6db74>&#34;let delayBody = &#39;&#39;;\n\ndelayBody += &#39;&lt;h1&gt;&#39; + msg.delayData.date + &#39;&lt;/h1&gt;\\n&#39;;\n\ndelayBody += &#39;&lt;h2&gt;&#39; + msg.delayData.morningTitle + &#39;&lt;/h2&gt;\\n&#39;;\ndelayBody += &#39;&lt;ul&gt;&#39;;\n\nif(msg.delayData.morningData.length === 0){\n    delayBody += &#39;&lt;li&gt;&#39;;\n    delayBody += &#39;遅延情報なし&#39;;\n    delayBody += &#39;&lt;/li&gt;&#39;;\n}else{\n    msg.delayData.morningData.forEach(function(data){\n        delayBody += &#39;&lt;li&gt;&#39;;\n        delayBody += &#39;&lt;a href=\&#34;&#39; + data.link + &#39;\&#34; target=\&#34;_blank\&#34;&gt;&#39;;\n        delayBody += data.zone + &#39; (&#39; + data.detail + &#39;)&#39;; \n        delayBody += &#39;&lt;/a&gt;&#39;;\n        delayBody += &#39;&lt;/li&gt;&#39;;\n    });\n}\n\ndelayBody += &#39;&lt;/ul&gt;&#39;;\ndelayBody += &#39;&lt;h2&gt;&#39; + msg.delayData.dayTitle + &#39;&lt;/h2&gt;\\n&#39;;\ndelayBody += &#39;&lt;ul&gt;&#39;;\n\nif(msg.delayData.dayData.length === 0){\n    delayBody += &#39;&lt;li&gt;&#39;;\n    delayBody += &#39;遅延情報なし&#39;;\n    delayBody += &#39;&lt;/li&gt;&#39;;\n}else{\n    msg.delayData.dayData.forEach(function(data){\n        delayBody += &#39;&lt;li&gt;&#39;;\n        delayBody += &#39;&lt;a href=\&#34;&#39; + data.link + &#39;\&#34; target=\&#34;_blank\&#34;&gt;&#39;;\n        delayBody += data.zone + &#39; (&#39; + data.detail + &#39;)&#39;; \n        delayBody += &#39;&lt;/a&gt;&#39;;\n        delayBody += &#39;&lt;/li&gt;&#39;;\n    });\n}\n\ndelayBody += &#39;&lt;/ul&gt;&#39;;\ndelayBody += &#39;&lt;h2&gt;&#39; + msg.delayData.nightTitle + &#39;&lt;/h2&gt;\\n&#39;;\ndelayBody += &#39;&lt;ul&gt;&#39;;\n\nif(msg.delayData.nightData.length === 0){\n    delayBody += &#39;&lt;li&gt;&#39;;\n    delayBody += &#39;遅延情報なし&#39;;\n    delayBody += &#39;&lt;/li&gt;&#39;;\n}else{\n    msg.delayData.nightData.forEach(function(data){\n        delayBody += &#39;&lt;li&gt;&#39;;\n        delayBody += &#39;&lt;a href=\&#34;&#39; + data.link + &#39;\&#34; target=\&#34;_blank\&#34;&gt;&#39;;\n        delayBody += data.zone + &#39; (&#39; + data.detail + &#39;)&#39;; \n        delayBody += &#39;&lt;/a&gt;&#39;;\n        delayBody += &#39;&lt;/li&gt;&#39;;\n    });\n}\n\ndelayBody += &#39;&lt;/ul&gt;&#39;;\nmsg.delayBody =  delayBody;\nreturn msg;&#34;</span>,<span style=color:#f92672>&#34;outputs&#34;</span>:<span style=color:#ae81ff>1</span>,<span style=color:#f92672>&#34;noerr&#34;</span>:<span style=color:#ae81ff>0</span>,<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>360</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>260</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[[<span style=color:#e6db74>&#34;5f89b7b8.249788&#34;</span>]]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;6e8b7f2.3c2238&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;function&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;ページの要素を結合&#34;</span>,<span style=color:#f92672>&#34;func&#34;</span>:<span style=color:#e6db74>&#34;let bodyHeader = &#39;&lt;html&gt;&lt;header&gt;&lt;meta name=\&#34;viewport\&#34; content=\&#34;width=device-width, initial-scale=1, shrink-to-fit=no\&#34;&gt;&lt;link rel=\&#34;stylesheet\&#34; href=\&#34;https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css\&#34; integrity=\&#34;sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS\&#34; crossorigin=\&#34;anonymous\&#34;&gt;&lt;/header&gt;&lt;body&gt;&lt;div class=\&#34;container\&#34;&gt;&lt;div class=\&#34;row\&#34;&gt;&lt;div class=\&#34;col-sm my-2\&#34;&gt;&#39;;\nlet bootstrap = &#39;&lt;script src=\&#34;https://code.jquery.com/jquery-3.3.1.slim.min.js\&#34; integrity=\&#34;sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo\&#34; crossorigin=\&#34;anonymous\&#34;&gt;&lt;/script&gt;&lt;script src=\&#34;https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js\&#34; integrity=\&#34;sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut\&#34; crossorigin=\&#34;anonymous\&#34;&gt;&lt;/script&gt;&lt;script src=\&#34;https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js\&#34; integrity=\&#34;sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k\&#34; crossorigin=\&#34;anonymous\&#34;&gt;&lt;/script&gt;&#39;;\nlet bodyFooter = &#39;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;&#39;;\n\nmsg.payload = bodyHeader + msg.delayBody + msg.mailBody + msg.scriptBody + bootstrap + bodyFooter;\nreturn msg;&#34;</span>,<span style=color:#f92672>&#34;outputs&#34;</span>:<span style=color:#ae81ff>1</span>,<span style=color:#f92672>&#34;noerr&#34;</span>:<span style=color:#ae81ff>0</span>,<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>360</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>380</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[[<span style=color:#e6db74>&#34;bbc86a41.f453e8&#34;</span>]]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;5f89b7b8.249788&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;function&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;メール送信部分&#34;</span>,<span style=color:#f92672>&#34;func&#34;</span>:<span style=color:#e6db74>&#34;let mailBody = &#39;&#39;;\n\nmailBody += &#39;&lt;h1&gt;勤怠メールを作成&lt;/h1&gt;&#39;;\n\nmailBody += &#39;&lt;label for=\&#34;reason\&#34;&gt;遅延理由を選択する&lt;/label&gt;&#39;;\nmailBody += &#39;&lt;select class=\&#34;custom-select\&#34; name=\&#34;reason\&#34; id=\&#34;reason\&#34; onchange=\&#34;updateMessage()\&#34;&gt;&#39;;\nmailBody += &#39;&lt;option value=\&#34;電車遅延のため\&#34; selected&gt;電車遅延&lt;/option&gt;&#39;;\nmailBody += &#39;&lt;option value=\&#34;腹痛のため\&#34;&gt;体調不良（腹痛）&lt;/option&gt;&#39;;\nmailBody += &#39;&lt;option value=\&#34;頭痛のため\&#34;&gt;体調不良（頭痛）&lt;/option&gt;&#39;;\nmailBody += &#39;&lt;option value=\&#34;体調不良のため\&#34;&gt;体調不良（理由なし）&lt;/option&gt;&#39;;\nmailBody += &#39;&lt;option value=\&#34;保育園登園に時間がかかったため\&#34;&gt;保育園関係&lt;/option&gt;&#39;;\nmailBody += &#39;&lt;option value=\&#34;家事都合のため\&#34;&gt;家事都合&lt;/option&gt;&#39;;\nmailBody += &#39;&lt;option value=\&#34;私用のため\&#34;&gt;私用&lt;/option&gt;&#39;;\nmailBody += &#39;&lt;/select&gt;&#39;;\n\nmailBody += &#39;&lt;label for=\&#34;chien\&#34;&gt;遅延証明書へのリンクを貼る&lt;/label&gt;&#39;;\nmailBody += &#39;&lt;select class=\&#34;custom-select\&#34; name=\&#34;chien\&#34; id=\&#34;chien\&#34; onchange=\&#34;updateMessage()\&#34;&gt;&#39;;\nmailBody += &#39;&lt;option value=\&#34;\&#34; selected&gt;なし&lt;/option&gt;&#39;;\n\nmsg.delayData.allData.forEach(function(value){\n    mailBody += &#39;&lt;option value=\&#34;&#39; + value.link +  &#39;\&#34;&gt;&#39; + value.title + &#39;&lt;/option&gt;&#39;;\n});\n\nmailBody += &#39;&lt;/select&gt;&#39;;\n\nmailBody += &#39;&lt;label for=\&#34;message\&#34;&gt;メール本文&lt;/label&gt;&#39;;\nmailBody += &#39;&lt;textarea class=\&#34;form-control\&#34; id=\&#34;message\&#34; rows=\&#34;5\&#34;&gt;&lt;/textarea&gt;&#39;;\nmailBody += &#39;&lt;br&gt;&lt;button type=\&#34;button\&#34; class=\&#34;btn btn-primary btn-block\&#34; onclick=\&#34;sendMessage()\&#34;&gt;勤怠メールを送る&lt;/button&gt;&#39;;\n\nmsg.mailBody = mailBody;\nreturn msg;&#34;</span>,<span style=color:#f92672>&#34;outputs&#34;</span>:<span style=color:#ae81ff>1</span>,<span style=color:#f92672>&#34;noerr&#34;</span>:<span style=color:#ae81ff>0</span>,<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>340</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>300</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[[<span style=color:#e6db74>&#34;a41aa11e.86e04&#34;</span>]]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;a41aa11e.86e04&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;function&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;スクリプト部分&#34;</span>,<span style=color:#f92672>&#34;func&#34;</span>:<span style=color:#e6db74>&#34;let name = global.get(&#39;name&#39;);\nlet address = global.get(&#39;address&#39;);\n\nlet scriptBody = &#39;&lt;script&gt;&#39;;\nscriptBody += &#39;let reasonSelect = document.getElementById(\&#34;reason\&#34;); let chienSelect = document.getElementById(\&#34;chien\&#34;); let textArea = document.getElementById(\&#34;message\&#34;); function updateMessage() { let reasonIndex = reasonSelect.selectedIndex; let chienIndex = chienSelect.selectedIndex; let message = \&#34;\&#34;; message += \&#34;&#39; + name + &#39;です。\\\\n\\\\n\&#34;; message += \&#34;大変申し訳ありませんが、\&#34;; message += reasonSelect.options[reasonIndex].value; message += \&#34;出社が遅れます。\\\\n\&#34;; message += \&#34;何卒宜しくお願いします。\&#34;; if (!chienSelect.options[chienIndex].value) { textArea.value = message; return; } let request = new XMLHttpRequest(); request.onload = function () { message += \&#34;\\\\n\\\\n遅延証明書はこちらです。\\\\n\&#34;; message += request.responseText; textArea.value = message; }; request.open(\&#34;GET\&#34;, \&#34;./encode/\&#34; + encodeURIComponent(chienSelect.options[chienIndex].value.trim()), false, \&#34;USER_NAME\&#34;, \&#34;PASSWORD\&#34;); request.send(); } function sendMessage() { window.open(\&#34;mailto:&#39; + address + &#39;?body=\&#34; + encodeURIComponent(textArea.value)); } updateMessage();&#39;;\nscriptBody += &#39;&lt;/script&gt;&#39;;\n\nmsg.scriptBody = scriptBody;\nreturn msg;&#34;</span>,<span style=color:#f92672>&#34;outputs&#34;</span>:<span style=color:#ae81ff>1</span>,<span style=color:#f92672>&#34;noerr&#34;</span>:<span style=color:#ae81ff>0</span>,<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>340</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>340</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[[<span style=color:#e6db74>&#34;6e8b7f2.3c2238&#34;</span>]]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;867b9e9b.bb5b8&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;http in&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;HTTPリクエスト&#34;</span>,<span style=color:#f92672>&#34;url&#34;</span>:<span style=color:#e6db74>&#34;/encode/:url&#34;</span>,<span style=color:#f92672>&#34;method&#34;</span>:<span style=color:#e6db74>&#34;get&#34;</span>,<span style=color:#f92672>&#34;upload&#34;</span>:<span style=color:#66d9ef>false</span>,<span style=color:#f92672>&#34;swaggerDoc&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>120</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>480</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[[<span style=color:#e6db74>&#34;eb246d76.1afeb&#34;</span>,<span style=color:#e6db74>&#34;fdb9da8c.f0ebf8&#34;</span>]]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;55421d41.0dc1b4&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;http response&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;HTTPレスポンス&#34;</span>,<span style=color:#f92672>&#34;statusCode&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;headers&#34;</span>:{},<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>610</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>480</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;303db0f1.b72bf&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;http request&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;APIを叩く&#34;</span>,<span style=color:#f92672>&#34;method&#34;</span>:<span style=color:#e6db74>&#34;GET&#34;</span>,<span style=color:#f92672>&#34;ret&#34;</span>:<span style=color:#e6db74>&#34;txt&#34;</span>,<span style=color:#f92672>&#34;url&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;tls&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>330</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>520</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[[<span style=color:#e6db74>&#34;55421d41.0dc1b4&#34;</span>]]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;808e61ff.edc38&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;function&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;URL変換&#34;</span>,<span style=color:#f92672>&#34;func&#34;</span>:<span style=color:#e6db74>&#34;msg.url = &#39;https://is.gd/create.php?format=simple&amp;url=&#39; + encodeURIComponent(msg.req.params.url);\nreturn msg;&#34;</span>,<span style=color:#f92672>&#34;outputs&#34;</span>:<span style=color:#ae81ff>1</span>,<span style=color:#f92672>&#34;noerr&#34;</span>:<span style=color:#ae81ff>0</span>,<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>320</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>480</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[[<span style=color:#e6db74>&#34;303db0f1.b72bf&#34;</span>]]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;eb246d76.1afeb&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;debug&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;active&#34;</span>:<span style=color:#66d9ef>true</span>,<span style=color:#f92672>&#34;tosidebar&#34;</span>:<span style=color:#66d9ef>true</span>,<span style=color:#f92672>&#34;console&#34;</span>:<span style=color:#66d9ef>false</span>,<span style=color:#f92672>&#34;tostatus&#34;</span>:<span style=color:#66d9ef>false</span>,<span style=color:#f92672>&#34;complete&#34;</span>:<span style=color:#e6db74>&#34;true&#34;</span>,<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>310</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>560</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;b475750f.2c9468&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;comment&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;ページへのアクセス&#34;</span>,<span style=color:#f92672>&#34;info&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>130</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>140</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;b61cb0ab.67446&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;comment&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;URL短縮&#34;</span>,<span style=color:#f92672>&#34;info&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>100</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>440</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;892cd0e6.0c4ae&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;comment&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;定数の宣言&#34;</span>,<span style=color:#f92672>&#34;info&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>100</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>40</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;92da441f.e87958&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;inject&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;起動時&#34;</span>,<span style=color:#f92672>&#34;topic&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;payload&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;payloadType&#34;</span>:<span style=color:#e6db74>&#34;date&#34;</span>,<span style=color:#f92672>&#34;repeat&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;crontab&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;once&#34;</span>:<span style=color:#66d9ef>true</span>,<span style=color:#f92672>&#34;onceDelay&#34;</span>:<span style=color:#ae81ff>0.1</span>,<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>100</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>80</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[[<span style=color:#e6db74>&#34;7e9e582f.c0d258&#34;</span>]]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;7e9e582f.c0d258&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;function&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;差出人、宛先の設定&#34;</span>,<span style=color:#f92672>&#34;func&#34;</span>:<span style=color:#e6db74>&#34;global.set(&#39;name&#39;, &#39;ポキオ&#39;);\nglobal.set(&#39;address&#39;, &#39;example@example.com&#39;);\nreturn msg;&#34;</span>,<span style=color:#f92672>&#34;outputs&#34;</span>:<span style=color:#ae81ff>1</span>,<span style=color:#f92672>&#34;noerr&#34;</span>:<span style=color:#ae81ff>0</span>,<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>360</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>80</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[[]]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;b83cd390.27959&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;node-red-contrib-httpauth&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;BASIC認証&#34;</span>,<span style=color:#f92672>&#34;file&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;cred&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;authType&#34;</span>:<span style=color:#e6db74>&#34;Basic&#34;</span>,<span style=color:#f92672>&#34;realm&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;username&#34;</span>:<span style=color:#e6db74>&#34;USER_NAME&#34;</span>,<span style=color:#f92672>&#34;password&#34;</span>:<span style=color:#e6db74>&#34;PASSWORD&#34;</span>,<span style=color:#f92672>&#34;hashed&#34;</span>:<span style=color:#66d9ef>false</span>,<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>110</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>220</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[[<span style=color:#e6db74>&#34;a45bf2b.b54621&#34;</span>]]},{<span style=color:#f92672>&#34;id&#34;</span>:<span style=color:#e6db74>&#34;fdb9da8c.f0ebf8&#34;</span>,<span style=color:#f92672>&#34;type&#34;</span>:<span style=color:#e6db74>&#34;node-red-contrib-httpauth&#34;</span>,<span style=color:#f92672>&#34;z&#34;</span>:<span style=color:#e6db74>&#34;7cbe5b40.a0b054&#34;</span>,<span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;BASIC認証&#34;</span>,<span style=color:#f92672>&#34;file&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;cred&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;authType&#34;</span>:<span style=color:#e6db74>&#34;Basic&#34;</span>,<span style=color:#f92672>&#34;realm&#34;</span>:<span style=color:#e6db74>&#34;&#34;</span>,<span style=color:#f92672>&#34;username&#34;</span>:<span style=color:#e6db74>&#34;USER_NAME&#34;</span>,<span style=color:#f92672>&#34;password&#34;</span>:<span style=color:#e6db74>&#34;PASSWORD&#34;</span>,<span style=color:#f92672>&#34;hashed&#34;</span>:<span style=color:#66d9ef>false</span>,<span style=color:#f92672>&#34;x&#34;</span>:<span style=color:#ae81ff>110</span>,<span style=color:#f92672>&#34;y&#34;</span>:<span style=color:#ae81ff>520</span>,<span style=color:#f92672>&#34;wires&#34;</span>:[[<span style=color:#e6db74>&#34;808e61ff.edc38&#34;</span>]]}]
</code></pre></div><p>フローエディターは、こんな感じになっています。</p><h2 id=heroku>Herokuにデプロイして本格運用</h2><p>今回は、enebularが提供してるNode-REDの仕組みを利用して、フローを設計してみました。</p><p>フロー設計時にはテンポラリのエンドポイントURLが付与されるので、作りながら実際のWebページの挙動を試すことができます。</p><p>また、実際に本格運用しようと思ったときも、enebularからHerokuやAWS Lambdaにフローをデプロイ可能なので、簡単に日々の業務改善ツールとして導入可能です。enebularも無料で始められますし、HerokuやAWSも無料枠で運用することが可能です。</p><p>サクッと業務改善ツールが作れる環境が揃っているので、みなさんもぜひ作ってみてください！</p></div><div class=share-foot><a href=https://twitter.com/share class=twitter-share-button data-size=large data-show-count=true data-hashtags=dotstudio>Tweet</a>
&nbsp;<div class=fb-share-button data-href=https://dotstud.io/blog/pokio-nodered-keikyu-chien/ data-layout=button_count data-size=large data-mobile-iframe=true><a target=_blank href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdotstud.io%2Fblog%2Fmftokyo-2018-chantoku-report%2F&src=sdkpreparse" class=fb-xfbml-parse-ignore>シェア</a></div>&nbsp;
<a href=https://dotstud.io/blog/pokio-nodered-keikyu-chien/ class=hatena-bookmark-button data-hatena-bookmark-layout=basic-counter data-hatena-bookmark-height=30 title=このエントリーをはてなブックマークに追加><img src=https://b.st-hatena.com/images/entry-button/button-only@2x.png alt=このエントリーをはてなブックマークに追加 width=20 height=20 style=border:none></a>
&nbsp;<div class=line-it-button data-lang=ja data-type=share-c data-url=https://dotstud.io/blog/pokio-nodered-keikyu-chien/ style=display:none></div></div><nav class=related><h2>関連記事</h2><ul class=cards-related><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/cloudflare-cache-clear-nodejs/><img class=card-related--thumbnail src=/img/blog/242/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>CloudflareのAPIをNode.js+GitLab CIから実行してキャッシュクリアしてみよう</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/update-nefrybt-to-googledrive/><img class=card-related--thumbnail src=/img/blog/241/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>NefryBTからGoogleDriveにデータをアップロードする方法</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/gitlab-vuepress-custom-domain/><img class=card-related--thumbnail src=/img/blog/239/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>VuePressのブログをカスタムドメイン+SSL対応させたGitLab Pagesにデプロイする</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/face-robot-making-basic2/><img class=card-related--thumbnail src=/img/blog/240/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>Let's 顔面製造！第二弾！ 歌うサンタ顔面ロボットを作ろう</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/arduino-nodejs-twitter-connect/><img class=card-related--thumbnail src=/img/blog/230/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>ArduinoでTwitter連携！愛しのぬいぐるみトンピーちゃんに命を吹き込んでみた</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/developed-iot-using-moddable/><img class=card-related--thumbnail src=/img/blog/237/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>Moddable SDKを使ってJavaScriptでIoT開発してみた</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/static-site-hosting-surge/><img class=card-related--thumbnail src=/img/blog/219/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>無料で手軽！コマンド一つで静的サイトホスティングできるSurgeを試してみた。</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/node-school-1-3/><img class=card-related--thumbnail src=/img/blog/157/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>NodeSchoolでNode.jsの学習を始めよう！#2 - 問題1〜3の解答と解説</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/node-school-before-learn/><img class=card-related--thumbnail src=/img/blog/156/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>NodeSchoolでNode.jsの学習を始めよう！インストール手順から基本操作までステップ別解説</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/how-to-use-cli/><img class=card-related--thumbnail src=/img/blog/158/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>【Mac向け】「黒い画面」の苦手意識を克服しよう！コマンドラインインタフェースの基本操作</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/gmail-api-from-nodejs/><img class=card-related--thumbnail src=/img/blog/150/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>Google公式ライブラリを利用してNode.jsからGmailの送受信をしてみよう</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/nodejs-install-use-nodebrew/><img class=card-related--thumbnail src=/img/blog/136/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>Node.jsを始めよう！nodebrewを使って5分で環境構築</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/google-spreadsheets-from-nodejs/><img class=card-related--thumbnail src=/img/blog/135/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>Node.jsでGoogle SpreadSheetsを操作してみよう。【GAS不使用】</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/hexo-static-site-vol3/><img class=card-related--thumbnail src=/img/blog/108/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>Node.js製の静的サイトジェネレータ「Hexo」で無料ブログ開発 vol.3</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/linedevday-report-2017-gatebox/><img class=card-related--thumbnail src=/img/blog/128/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>#linedevday 2017レポート！ Clova連携で期待のGateboxの技術話を聞いてみたよ</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/hexo-static-site-vol2/><img class=card-related--thumbnail src=/img/blog/107/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>Node.js製の静的サイトジェネレータ「Hexo」で無料ブログ開発 vol.2</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/hexo-static-site-vol1/><img class=card-related--thumbnail src=/img/blog/105/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>Node.js製の静的サイトジェネレータ「Hexo」で無料ブログ開発 vol.1</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/operate-mysql-from-nodejs/><img class=card-related--thumbnail src=/img/blog/068/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>Node.jsアプリケーションからMySQLにアクセスする</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/nodejs-npm-chokidar-fswatch/><img class=card-related--thumbnail src=/img/blog/035/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>Node.jsでファイル監視を行うchokidarを使ってみよう</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/nodejs-hosting-services-2016/><img class=card-related--thumbnail src=/img/blog/061/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>2016年12月版　Node.jsをホスティング出来るPaaSまとめ</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/nodejs-npm-readline-sync/><img class=card-related--thumbnail src=/img/blog/024/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>Node.jsでコマンドラインツール作るときに使いやすいreadline-sync</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/pepper-pokemon-go-notice/><img class=card-related--thumbnail src=/img/blog/017/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>Pokemon GOで近くにポケモンが出たらPepperが教えてくれる仕組みをNode.jsだけで作る</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/nodebots-kit-guide-vol1/><img class=card-related--thumbnail src=/img/blog/004/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>史上初!? NodeBotsの日本向けキットを作成しました！ #nodebots</h3></a></article></li><li class=js-items><article class=card-related><a href=https://dotstud.io/blog/nodebots-handson-report-vol2/><img class=card-related--thumbnail src=/img/blog/003/00_thumbnail.png alt=サムネイル><h3 class=card-related--title>今週末はInternational NodeBots Dayですよ！( #NodeBots vol2のイベレポと次回告知 )</h3></a></article></li></ul></nav></article><footer class=footer><p class=footer-info><a class=footer-info--item href=/about>会社概要</a>
<a class=footer-info--item href=/members>メンバー</a>
<a class=footer-info--item href=/recruit>採用情報</a>
<a class=footer-info--item href=/legal#tos>利用規約</a>
<a class=footer-info--item href=/legal#sct>特定商取引</a>
<a class=footer-info--item href=/legal#pp>プライバシーポリシー</a></p><p class=footer-cr>© 2018 dotstudio inc.</p></footer><script src=/js/jquery.min.js></script><script src=/js/app.js></script><script src=/js/lib/hljs.js></script><script src=/js/lib/hljs-numbers.js></script><script>hljs.initHighlightingOnLoad();hljs.initLineNumbersOnLoad();</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-78080011-1','auto');ga('send','pageview');</script></body>